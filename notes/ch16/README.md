# ch.16 라우팅

- URL 라우팅: URL을 애플리케이션 안의 특정 컴포넌트 혹은 페이지로 매핑하는 과정
- 라우팅을 통해 사용자들은 브라우저 주소창에 URL을 입력하거나 하이퍼링크를 클릭해 뷰를 탐색할 수 있다

## 16-1. 사용자에게 라우팅이 중요한 이유는 무엇인가?

1. 내비게이션 및 탐색 용이성(discoverability)

- 라우팅 구조가 지도 역할을 해서 컨텐츠와 기능을 쉽게 찾을 수 있다

2. 북마킹 및 공유

- 라우팅을 사용하면 각각의 뷰나 페이지는 하나의 고유한 URL을 갖는다. 이 URL을 브라우저 북마크로 등록하거나 다른 사용자에게 공유할 수 있다.

3. 이전 페이지 및 다음 페이지 탐색
4. SEO 및 인덱싱

- 고유 URL은 검색 엔진이 서비스를 더 잘 찾게 해준다. 검색 엔진은 컨텐츠를 크롤링하고 인덱싱할 수 있고, 이는 서비스의 트래픽을 증가시킬 수 있다.

5. deep link

- deep link로 사용자를 특정 모바일 앱으로 이동시키고 원하는 화면을 보여주거나 사용자 액션을 유도할 수 있다.

6. 상태 관리 및 데이터 보존

- URL에 데이터를 저장하여 UI를 개선할 수 있다.

7. 권한 기반 접근 및 인증

- 사용자 역할과 인증 상태에 기반해 서로 다른 라우트를 보호 또는 제한할 수 있다.

### 전통적 애플리케이션 vs SPA

전통적 애플리케이션에서는 일반적으로 각 URL이 서버에서 보내지는 하나의 HTML에 해당한다. 사용자가 다른 URL을 탐색하면 브라우저가 서버에 요청을 보내고, 서버는 새로운 HTML을 응답한다.

- 느린 네비게이션: 각 탐색마다 full page reload가 필요해서 사용자 경험이 좋지 않다
- SEO 우수: 검색 엔진 크롤러가 완전히 렌더링된 각각의 HTML 페이지에 대해 쉽게 인덱스를 만들 수 있다
- 초기 로딩 시간 빠름: 랜딩 페이지만 불러오면 된다

반면 React 같은 SPA는 사용자가 다른 URL을 탐색해도 full page reload를 요청하지 않는다. 대신, 적절한 컴포넌트만 렌더링해서 UI를 업데이트한다.

- 빠르고 매끄러운 네비게이션
- SEO 불리
- 초기 로딩 시간 느림: 전체 애플리케이션을 미리 로딩해야 한다

## 16-2. React의 라우팅 솔루션

React Router

- `React.lazy()` 대신 `<Route lazy={() => import("./a")} />` 형태로 lazy loading 도 가능. 초기 번들 크기를 줄일 수 있다.

Next.js App router

- 라우트에 따라 자동 코드 스플리팅
- 서버 컴포넌트: 서버에서 실행되는 상태가 없는 React 컴포넌트
  - 계산이나 데이터 페칭 등의 작업을 서버 사이드에서 실행
  - 클라이언트 컴포넌트에서는 인터랙션 등을 처리
  - 기본적으로 서버 컴포넌트를 사용하고, 인터랙션이 필요한 경우에만 클라이언트 컴포넌트를 사용한다 (클라이언트 사이드 JS 번들 크기를 가볍게 유지할 수 있다)
  - 서버 컴포넌트는 클라이언트 사이드 API(브라우저 API, React Hooks)나 상태(useState 등)를 사용할 수 없다
  - 서버 컴포넌트는 클라이언트 사이드 네비게이션에 대해서도 항상 서버에서 렌더링되므로 가볍게 유지하고 무거운 계산을 피해야 UI가 매끄럽다
- 라우트 폴더 내 `loading.tsx`가 있다면 자동으로 보여지고(Suspense fallback UI 역할), 런타임 에러 발생 시 마찬가지로 `error.tsx`가 자동으로 보여진다
- `<Link />` 컴포넌트는 클라이언트 사이드 네비게이션을 최적으로 처리한다 (prefetch 등)
  - React Router의 `<Link />` 와 비슷

## 16-3. 정리

- 애플리케이션 요구사항(성능, SEO, SSR)에 따라 적절한 라우팅 접근법을 선택해야 한다
- 중첩된 라우팅(React Router)을 통해 모듈화되고 유지보수가 쉬운 애플리케이션 라우팅을 구현할 수 있다
- 라우팅 구현시 지연 로딩(Lazy Loading), 코드 스플리팅 등의 성능 최적화 기법을 고려할 수 있다
- 단순함, 성능, 유지보수성의 균형을 맞춰 확장 가능한 애플리케이션을 만들어 가야 한다
