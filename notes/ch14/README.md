# ch.14 기술적 마이그레이션

- 애플리케이션이 성장하고 기술이 진화하면서 기존 코드보다 새롭고 효율적인 기술 및 방법론에 맞는 코드로 마이그레이션 필요
- 기술적 마이그레이션 종류
  - 의존성, 라이브러리, 프레임워크 업그레이드 혹은 대체
  - 새로운 프로그래밍 언어 또는 플랫폼으로 이동
  - 새로운 버전의 데이터베이스 혹은 데이터 스토리지 시스템으로 마이그레이션
  - 테스팅, 모니터링, 디버깅을 위한 새로운 도구 혹은 방법론 도입
  - 성능, 유지보수성, 확장성 개선을 위한 기존 코드 리팩터링
  - 클라우드 기반 시스템같은 새로운 배포 인프라 스트럭처로 마이그레이션
  - 새로운 기능 혹은 비즈니스 요구사항을 지원하기 위한 애플리케이션 아키텍처 업데이트
  - 위협 혹은 취약성으로부터 보호하기 위한 새로운 보안 지표 구현

## 14-1. 다양한 마이그레이션 전략

- 예를 들어, 대규모의 레거시 자바스크립트 웹 애플리케이션을 업그레이드 해야할 때..

### 좋은 마이그레이션

- 애플리케이션의 코드를 완전히 새롭게 작성하여 업그레이드 효과 극대화
- 단, 시간이 많이 소요되므로 소규모 프로젝트에 적합

### 빠른 마이그레이션

- 점진적 마이그레이션: 부분 혹은 조각으로 나누고 각 부분을 점진적으로 마이그레이션
- 부분적 마이그레이션 적용 후 배포가 빨라져 마이그레이션 피드백을 빨리 얻을 수 있고, 애플리케이션을 사용할 수 없는 시간을 줄일 수 있다
- 의존성이나 프레임워크 충돌이 발생할 문제가 있다
  - 예: 한 애플리케이션에서 기능이 겹치는 2가지 도구를 동시에 사용할 경우
- 동일한 도구의 다른 버전을 지원하는 것이 문제를 일으킬 수 있다
  - 예: CSS cascade logic 같은 글로벌 정책

### 교살자 애플리케이션(strangler application)

교살자 무화과(strangler fig) 패턴

- 마틴 파울러가 제시한 개념으로, 교살자 무화과 나무가 타겟 나무를 서서히 죽이는 것에서 유래
- 레거시 코드를 최신 코드로 리디렉션하거나, 이전 코드를 최신 코드로 래핑
- 레거시 코드를 아예 없애지 않고 기록
- 최신 코드가 레거시 코드를 서서히 없애나감(교살과 비슷)
- 구식 컴포넌트를 새로운 컴포넌트로 점진적으로 대체하면서 마이그레이션에 의한 잠재적 리스크를 줄임

### 하이브리드 접근법

- 앞서 설명한 전략들을 섞어서 쓰기
- 예: 중요한 컴포넌트의 경우 좋은 마이그레이션 전략 사용, 덜 중요한 컴포넌트의 경우 빠른 마이그레이션 전략 사용

## 14-2. 마이그레이션 핵심 요소

- 마이그레이션 범위 이해
- 마이그레이션 계획 수립
- 점진적 마이그레이션 구현
- 성능 모니터링 및 최적화
- 충분한 테스트
- 이해관계자 소통

## 14-3. 코드모드

코드모드

- 자바스크립트 애플리케이션의 코드 변경 프로세스를 자동화하는 스크립트
- 코드베이스를 스캔하고 필요한 변경을 자동 수행
- 구문 업데이트, 변경 사항 임포트, config 파일 업데이트 등을 수행 가능

예시: 모든 상대경로 import를 절대경로 import로 변환하기

- 스크립트 준비: Phenax의 absolute-import-codemod-transform.js 스크립트
- jscodeshift 같은 툴킷으로 코드모드 스크립트 실행

```bash
jscodeshift -t ./absolute-import-codemod-transform.js src/**/*.js
```

- 추가적으로 ES6 클래스 컴포넌트를 함수형 컴포넌트로 변경하기 등 작업 수행 가능

## 14-4. 생성형 AI

- 사람의 전문성을 대신하는 것이 아니라 보조하는 목적으로 사용해야 함
- 생성된 코드가 항상 정확한 것은 아니므로 사람이 직접 리뷰하거나 수정 필요
